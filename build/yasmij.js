String.prototype.trim=String.prototype.trim||function(){return(this||"").replace(/^\s+|\s+$/g,"");};var mixin={};mixin.getUniqueArray=function(arr){var result=[],hash={};if(typeof arr!=="object"||!arr.length){return result;}
for(var i=0,len=arr.length;i<len;i++){if(!hash[arr[i]]){result.push(arr[i]);hash[arr[i]]=1;}}
return result;};mixin.areObjectsSame=function(obj1,obj2){var a,b;if(obj1===obj2){return true;}
if(!(obj1 instanceof obj2.constructor)){return false;}
for(var prop in obj1){if(!obj1.hasOwnProperty(prop)){continue;}
a=obj1[prop];b=obj2[prop];if(typeof a==="object"){if(typeof a!==typeof b){return false;}
if(!mixin.areObjectsSame(a,b)){return false;}}else{if(a.toString()!==b.toString()){return false;}}}
return true;};var Expression=function(){this.terms={};};Expression.parse=function(str){var obj=new Expression();if(typeof str!=="string"||!str.length){return obj;}
Expression.checkString(str);str=Expression.addSpaceBetweenTerms(str);obj.terms=Expression.convertExpressionToObject(str);return obj;};Expression.encodeE=function(str){str=(str||"").toString();str=str.replace(/(\de)([+])(\d)/gi,"$1_plus_$3");str=str.replace(/(\de)([\-])(\d)/gi,"$1_sub_$3");return str;};Expression.decodeE=function(str){str=(str||"").toString();str=str.replace(/_plus_/g,"+");str=str.replace(/_sub_/g,"-");return str;};Expression.hasManyCompares=function(str){var RE_compares=/[<>]=?|=/g;var matches=(""+str).replace(/\s/g,"").match(RE_compares)||[];return 1<matches.length;};Expression.addSpaceBetweenTerms=function(str){str=Expression.encodeE(str);str=str.replace(/([\+\-])/g," $1 ");str=str.replace(/\s{2,}/g," ");str=str.trim();str=Expression.decodeE(str);return str;};Expression.hasExcludedOperations=function(str){return(/[\*\/%]/).test(str);};Expression.hasIncompleteBinaryOperator=function(str){var hasError,noSpaceStr=(""+str).replace(/\s/g,""),RE_hasNoPlusOrMinus=/^[^\+\-]+$/,RE_noLeftAndRightTerms=/[\+\-]{2}|[\+\-]$/,hasMoreThanOneTerm=/\S+\s+\S+/.test(str);hasError=hasMoreThanOneTerm&&RE_hasNoPlusOrMinus.test(noSpaceStr);hasError=hasError||RE_noLeftAndRightTerms.test(noSpaceStr);return hasError;};Expression.hasComparison=function(str){return(/[><=]/).test(str);};Expression.getErrorMessage=function(str){var errMsg;if(Expression.hasComparison(str)){errMsg="Comparison are not allowed within an expression.";}
if(!errMsg&&Expression.hasExcludedOperations(str)){errMsg="Addition and subtraction are only supported.";}
if(!errMsg&&Expression.hasIncompleteBinaryOperator(str)){errMsg="Exactly one math operators must be between terms.\n Good:(a+b). Bad:(a++ b+).";}
if(errMsg){errMsg+="\n Input: `"+str+"`";}
return errMsg;};Expression.checkString=function(str){var errMsg=Expression.getErrorMessage(str);if(errMsg){throw new Error(errMsg);}};Expression.extractComponentsFromVariable=function(str){str=""+str;var re=/^[\+\-]?\d+(\.\d+)?(e[\+\-]?\d+)?/i;var coeff=""+(str.match(re)||[""])[0];var term=str.replace(re,'')||"1";if(+str===0){coeff=0;}
if(coeff===""){coeff=/^\-/.test(term)?-1:1;term=term.replace(/^[\+\-]/,"");}
return[+coeff,term];};Expression.splitStrByTerms=function(str){var RE_findSignForTerm=/([\+\-])\s+/g;var RE_spaceOrPlus=/\s+[\+]?/;return(""+str).replace(/^\s*\+/,"").replace(RE_findSignForTerm,"$1").split(RE_spaceOrPlus);};Expression.convertExpressionToObject=function(str){var term,obj={},matches=Expression.splitStrByTerms((str||"").trim()),i=matches.length;while(i--){term=Expression.extractComponentsFromVariable(matches[i]);if(!term[0]){term=[0,1];}
obj[term[1]]=(obj[term[1]])?(obj[term[1]])+term[0]:term[0];}
return obj;};Expression.termAtIndex=function(i,name,value){var result="";if(value){if(value<0){result+=value==-1?"-":value;}else{if(i){result+="+";}
result+=value==1?"":value;}
result+=name;}else{result+=0<name&&i?"+":"";result+=name;}
return result;};Expression.prototype.getTermNames=function(){var obj=this.terms,terms=[],key;for(key in obj){if(!obj.hasOwnProperty(key)){continue;}
if(isNaN(key)){terms.push(key);}}
terms=terms.sort();if(obj&&obj[1]){terms.push(obj[1].toString());}
return terms;};Expression.prototype.forEachTerm=function(fn){if(typeof fn!=="function"){return;}
for(var prop in this.terms){if(this.terms.hasOwnProperty(prop)){fn(prop,this.terms[prop],this.terms);}}};Expression.prototype.forEachConstant=function(fn){if(typeof fn!=="function"){return;}
for(var prop in this.terms){if(this.terms.hasOwnProperty(prop)&&prop==="1"){fn(prop,this.terms[prop],this.terms);}}};Expression.prototype.forEachVariable=function(fn){if(typeof fn!=="function"){return;}
for(var prop in this.terms){if(this.terms.hasOwnProperty(prop)&&prop!=="1"){fn(prop,this.terms[prop],this.terms);}}};Expression.prototype.toString=function(){var arr=[],obj=this.terms,terms=this.getTermNames(),i,prop,len,func=Expression.termAtIndex;if(!terms.length){return"0";}
for(i=0,len=terms.length;i<len;i++){prop=terms[i];arr.push(func(i,prop,obj[prop]));}
return arr.join(" ").replace(/\s[\+\-]/g,"$& ");};Expression.prototype.inverse=function(){this.forEachTerm(function(termName,value,terms){terms[termName]=-value;});return this;};Expression.prototype.addTerm=function(name,value){value+=this.terms[name]||0;if(value){this.terms[name]=value;}else{this.removeTerm(name);}
return this;};Expression.prototype.removeTerm=function(name){delete this.terms[name];return this;};Expression.prototype.scale=function(factor){factor=+factor;this.forEachTerm(function(name,value,terms){terms[name]=(factor*value);});return this;};Expression.prototype.hasTerm=function(name){return!!this.terms[name];};Expression.prototype.getTermValue=function(name){return this.terms[name];};Expression.prototype.getCoeffients=function(){var arr=[];var names=this.getTermNames();for(var i=0,len=names.length;i<len;i++){arr.push(+(this.terms[names[i]]||names[i]));}
return arr;};var Input=function(){this.z=null;this.type=null;this.terms=null;this.constraints=null;this.isStandardMode=false;};Input.parse=function(type,z,constraints){var obj=new Input();obj.type=type;obj.z=z;obj.constraints=constraints;obj.checkForInputError();obj.convertConstraintsToStandardForm();obj.setTermNames();return obj;};Input.prototype.convertConstraintsToStandardForm=function(){var i=this.constraints.length;this.z=Expression.parse(this.z);while(i--){this.constraints[i]=Constraint.parse(this.constraints[i]);}};Input.prototype.addNumbersToSlacks=function(){var c=this.constraints;var slackI=1;for(var i=0,len=c.length;i<len;i++){if(c[i].slackValue){value=c[i].leftSide.getTermValue("slack");c[i].leftSide.removeTerm("slack");c[i].leftSide.addTerm("slack"+slackI,value);slackI++;}}};Input.prototype.setTermNames=function(){var vars=[],i=this.constraints.length,Constraint;while(i--){Constraint=this.constraints[i];vars=vars.concat(Constraint.getTermNames());}
this.terms=mixin.getUniqueArray(vars).sort();};Input.prototype.getErrors=function(){var errMsgs=[];if(typeof this.z!=="string"){errMsgs.push("z must be a string.");}
if(this.type!=="maximize"&&this.type!=="minimize"){errMsgs.push("`maximize` and `minimize` are the only types that is currently supported.");}
if("[object Array]"!==Object.prototype.toString.call(this.constraints)||!this.constraints){errMsgs.push("Constraints must be an array with at least one element.");}
return errMsgs;};Input.prototype.checkForInputError=function(){var arr=this.getErrors();if(arr&&arr.length){throw new Error("Input Error: "+arr.join('\n'));}};Input.prototype.toString=function(){return[this.type+" z = "+this.z,"where "+this.constraints.join(", ")].join(", ");};Input.prototype.convertConstraintsToMaxForm=function(){var c=this.constraints;for(var i=0,len=c.length;i<len;i++){c[i]=c[i].getStandardMaxForm();}};Input.prototype.convertToStandardForm=function(){if(this.isStandardMode){return this;}
if(/min/.test(this.type)){this.z=this.z.inverse();}
this.convertConstraintsToMaxForm();this.addNumbersToSlacks();this.setTermNames();this.isStandardMode=true;return this;};var Matrix=function(){this.array=[];this.rows=0;this.columns=0;};Matrix.isArray=function(obj){return Object.prototype.toString.call(obj)==="[object Array]";};Matrix.parse=function(input){var obj=new Matrix();if(Matrix.isArray(input)&&Matrix.isArray(input[0])){obj.array=input;}else{input=Matrix.isArray(input)?input:[input];obj.addRow(input);}
return obj;};Matrix.scaleRow=function(scale,row){if(!Matrix.isArray(row)){return row;}
row=row.concat();for(var i=0,len=row.length;i<len;i++){row[i]*=scale;}
return row;};Matrix.addRows=function(rowA,rowB){return Matrix.scaleAndAddRows(1,rowA,1,rowB);};Matrix.scaleAndAddRows=function(scaleA,rowA,scaleB,rowB){rowA=(Matrix.isArray(rowA))?rowA.concat():[];rowB=(Matrix.isArray(rowB))?rowB.concat():[];var len=Math.max(rowA.length,rowB.length);for(var i=0;i<len;i++){rowA[i]=(scaleA*(rowA[i]||0))+(scaleB*(rowB[i]||0));}
return rowA;};Matrix.prototype.addRow=function(arr){arr=(typeof arr!=="object")?[arr]:arr;this.array.push(arr);this.columns=Math.max(arr.length,this.columns);this.rows+=1;return this;};Matrix.prototype.getElement=function(i,j){return this.array[i][j];};Matrix.prototype.getColumn=function(j){var arr=[];this.forEachRow(function(i,row){arr.push(row[j]);});return arr;};Matrix.prototype.getRow=function(i){return this.array[i];};Matrix.prototype.get=function(row,col){if(!col&&col!==0){return this.getRow(row);}else if(row||row===0){return this.getElement(row,col);}else{return this.getColumn(col);}};Matrix.prototype.forEachRow=function(fn){if(typeof fn==="function"){for(var i=0,len=this.array.length;i<len;i++){fn(i,this.array[i],this.array);}}
return this;};Matrix.prototype.getMinElementInRow=function(rowI){var row=this.array[rowI]||[];var arr=[0,row[0]];for(var i=0,len=row.length;i<len;i++){if(row[i]<arr[1]){arr[0]=i;arr[1]=row[i];}}
return arr;};Matrix.prototype.toString=function(input){var str="";this.forEachRow(function(i,row){if(0<i){str+="\n";}
str+=row.join(', ');});return str;};Matrix.prototype.getSize=function(){return[this.columns,this.rows];};Matrix.prototype.scaleRow=function(scaleA,rowI){var row=this.array[rowI]||[];for(var i=0,len=row.length;i<len;i++){row[i]*=scaleA;}
return this;};var Tableau=function(){this.input=null;this.matrix=null;this.limit=1e4;this.state=null;};Tableau.prototype.checkForError=function(){if(!(this.input instanceof Input)){return"Must pass an instance from the Input class.";}};Tableau.parse=function(input){var obj=new Tableau();obj.input=input;obj.checkForError();obj.input.convertToStandardForm();obj.setMatrixFromInput();obj.state="created";return obj;};Tableau.prototype.setMatrixFromInput=function(){this.matrix=new Matrix();var names=this.input.getTermNames();for(var i=0,len=this.input.constraints.length;i<len;i++){this.matrix.addRow(this.getRow(names,i));}};Tableau.prototype.getRow=function(names,constraintI){var row;return row;};Tableau.prototype.toString=function(){return this.matrix.toString();};var Output=function(){this.matrix=null;this.result=null;};Output.prototype.toString=function(){var str="";str+="matrix = "+(this.matrix instanceof Matrix?this.matrix.toString():[]);str+="\n result = "+JSON.stringify(result);return str;};var Simplex=function(){this.input=new Input();this.output=new Output();this.tableau=new Tableau();this.state=null;};Simplex.prototype.toString=function(){};Simplex.prototype.setInput=function(obj){this.input.parse(obj);};var YASMIJ=function(){};